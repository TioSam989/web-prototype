import"./sptJs.fc669d6c.js";import{g as V}from"./sptSearchJs.a4b56eb7.js";import{g as ne}from"./sptSimilarJs.6d635d55.js";const oe="0394adacbab6526b446f377465aae302";function se(e){let n=e.replace(/\s*\(.*?\)\s*/g,"");return n!=""||n!=null?n:e}function W(e,n){if(listResults.value="",e=="")divResults;else{const r=`https://ws.audioscrobbler.com/2.0/?method=track.search&track=${e}&api_key=0394adacbab6526b446f377465aae302&format=json&limit=${n}`;fetch(r,{method:"get",mode:"cors",cache:"no-store",timeout:1e3}).then(a=>{a.json().then(c=>{let d=Object.values(c)[0],p=Object.values(d)[4],h=Object.values(p)[0],g=[];Object.keys(h).map(function(S){let y={name:se(h[S].name),artist:h[S].artist};return g.push(y),g})}).catch(c=>console.error(`i'm broke: ${c.message}`))})}}function ae(e,n,r){const s=`https://ws.audioscrobbler.com/2.0/?method=track.getsimilar&track=${e}&artist=${n}&api_key=${oe}&limit=${r}&format=json&autocorrect=1`;return fetch(s,{method:"GET",mode:"cors",cache:"default"}).then(c=>c.json().then(d=>d)).catch(c=>K(c.message))}(function(){const e="on",n="out",r="body",s="stop",a="click",c="apply",d="target",p="prototype",h="Propagation",g="setAttribute",S="relatedTarget",y="addEventListener",m=Symbol(n),B=Object,L=document,H=typeof TouchEvent<"u"?TouchEvent:void 0,O=HTMLElement,M=O[p],x=Event[p],U=[a,"dbl"+a,"mousedown","mouseup","touchstart","touchend","pointerdown","pointerup"],F=new Set(U),w=new Set(U.map(t=>e+t+n)),T=(t,o)=>!!o&&t instanceof o,k=(t,o)=>t.contains(o),f=(t,o)=>{for(let i of t)o(i)},A=t=>{T(t,O)&&(t[m]?C(t):f(F,o=>{let i=e+o+n,b=t.getAttribute(i);b&&!_(t)[i]&&t[g](i,b)}),f(t.childNodes,A))},_=t=>t[m]=t[m]||{},C=t=>{_(t),v.includes(t)||(v.push(t),R=!0)},ee=(t,o)=>k(o,t)?1:k(t,o)?-1:0,te=t=>{R&&(v.sort(ee),R=!1);let o=t[d];T(t,H)?(t=new H(t.type+n,t))[S]=o:t=new t.constructor(t.type+n,B.assign({},t,{[S]:o})),t[s]=[],f(v,i=>{k(i,o)||t[s].some(b=>k(b,i))||i.dispatchEvent(t)})},G=t=>function(){let o=this,i=o.type;t[c](o),w.has(e+i)&&o[s].push(o[d])},$=(t,o,i)=>t[o]=i(t[o]);function re(t){let o=this[m][e+t.type];o&&o[c](this,[t])}let v=[],R=!1,z=L.createElement(r);f(F,t=>{L[y](t,te,{passive:!0,capture:!0});let o=e+t+n;B.defineProperty(M,o,{get(){return this[m][o]},set(i){this[y](t+n,re),this[m][o]=typeof i=="object"?i.handleEvent:i}})}),$(M,y,t=>function(...o){w.has(e+o[0])&&C(this),t[c](this,o)}),$(M,g,t=>function(o,i){w.has(o)?(t[c](z,[e+a,i]),this[o]=z[e+a]):t[c](this,[o,i])}),$(x,s+h,G),$(x,s+"Immediate"+h,G),new MutationObserver(t=>{f(t,o=>{f(o.addedNodes,A),f(o.removedNodes,i=>{T(i,O)&&(v=v.filter(b=>!k(i,b)))})})}).observe(L.documentElement,{childList:!0,subtree:!0}),A(L[r])})();const l=document.querySelector("#musicName");document.querySelector("#artistName");document.querySelector("#searchBtn");const u=document.querySelector("#listResults"),j=Y(u),q=Y(j),X=document.querySelector("#appMusicRec"),ie=Z(W,0),ce=Z(V(1e3)),I={first:"audioscrobbler",second:"musicovery",third:"spotify"};function Y(e){return e.parentNode}function Z(e,n=1){let r;return function(...s){clearTimeout(r),r=setTimeout(()=>{e(...s)},n)}}function le(e,n){u.innerHTML="";let r=[...new Set(e)];for(let s=r.length;s>n;s--)r.shift();return r}function N(e,n=!1){let r=document.createElement("option");r.text=`${e.name} from ${e.artist}`,n?(r.value=`${e.trackId} - ${e.artistId} - ${e.market}`,r.setAttribute("id",`${e.trackId}-${e.market}`)):(r.value=`${e.name},${e.artist}`,r.setAttribute("id",`${e.name}-${e.artist}`)),u.appendChild(r)}function K(e){console.error(e)}function E(e){return e.replaceAll(" ","+")}function D(e){e.removeAttribute("hidden","hidden")}function ue(e,n,r){if(n==I.first){let s=Object.values(e)[0],a=Object.values(s)[0],c=[];return Object.keys(a).map(function(d){let p={name:a[d].name,artist:a[d].artist.name};c.push(p)}),c}else if(n==I.second)if(r){let s=Object.values(e)[2],a=Object.values(s)[0];Object.keys(a).map(function(c){a[c].title,a[c].artist.name,a[c].id})}else{let s=Object.values(e),a=Object.values(s[2]);return{name:a[1],artist:a[4].name,id:a[0]}}}function de(e,n){let r=[...new Set(e)];for(let s=r.length;s>n;s--)r.shift();if(e==null||!e)throw"list indefinied";return r}function fe(e){let n=e.split(""),r=[];for(let s=0;s<n.length;s++)n[s]!=" "&&r.push(n[s]);return r}function pe(e){return!(e==null||e==null)}function P(e){if(pe(e)==!1)return!1;{let n=[];return n=fe(e),n.length!=0}}function he(e){X.innerHTML+=`<p>Listen to ${e.name} from ${e.artist} </p>`}function J(){X.innerHTML=""}async function Q(e,n=!1){if(l.value=`${e.name}`,n)try{try{let r=await ne(e)}catch(r){console.error(r)}}catch(r){console.error(r)}else try{const r=await ae(E(e.name),E(e.artist),5);let s=de(ue(r,I.first,5),5);try{if(s.length==0)throw"Music Not Found";J(),s.map(a=>{he(a)})}catch(a){console.error(a),a=="Music Not Found"&&(J(),K())}}catch(r){console.error(r)}}u.addEventListener("change",function(){try{let n=u.value.split(" - "),r={trackId:n[0],artistId:n[1],market:n[2]};Q(r,!0)}catch(e){console.error(e);try{console.log("Using option B to select opt on change event");let r=u.value.split(","),s={name:r[0],artist:r[1]};Q(s)}catch(n){console.error(n)}}});l.addEventListener("focus",e=>{if(P(l.value)==!0)if(u.childElementCount==0)try{ce(l.value).map(r=>{N(r,!0)})}catch(n){console.error(n);try{console.log("using Option B to search on focus"),ie(E(l.value),5)}catch(r){console.error(r)}}else D(j)});q.addEventListener("clickout",e=>{});q.addEventListener("mouseover",e=>{P(l.value)==!0&&D(j)});q.addEventListener("mouseout",e=>{});l.addEventListener("input",async e=>{if(P(l.value)!=!1){D(j),u.value="";try{u.innerHTML="",u.value="",(await V(l.value)).map(r=>N(r,!0))}catch(n){console.error(n);try{console.log("using option B to Search on input");let r=await W(E(l.value),5);le(r,limit).map(s=>N(s))}catch(r){console.error(r)}}}});export{ae as a,W as g};
