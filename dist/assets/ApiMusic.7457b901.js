import"./sptJs.910febd8.js";import{g as V}from"./sptSearchJs.bbb13094.js";import{g as oe}from"./sptSimilarJs.85992db2.js";const se="0394adacbab6526b446f377465aae302";function ae(e){let r=e.replace(/\s*\(.*?\)\s*/g,"");return r!=""||r!=null?r:e}function W(e,r){if(listResults.value="",e=="")divResults;else{const n=`https://ws.audioscrobbler.com/2.0/?method=track.search&track=${e}&api_key=0394adacbab6526b446f377465aae302&format=json&limit=${r}`;fetch(n,{method:"get",mode:"cors",cache:"no-store",timeout:1e3}).then(a=>{a.json().then(i=>{let d=Object.values(i)[0],h=Object.values(d)[4],m=Object.values(h)[0],b=[];Object.keys(m).map(function(y){let S={name:ae(m[y].name),artist:m[y].artist};b.push(S),ue(b,r).map(p=>D(p))})}).catch(i=>console.error(`i'm broke: ${i.message}`))})}}function ie(e,r,n){const s=`https://ws.audioscrobbler.com/2.0/?method=track.getsimilar&track=${e}&artist=${r}&api_key=${se}&limit=${n}&format=json&autocorrect=1`;return fetch(s,{method:"GET",mode:"cors",cache:"default"}).then(i=>i.json().then(d=>d)).catch(i=>K(i.message))}(function(){const e="on",r="out",n="body",s="stop",a="click",i="apply",d="target",h="prototype",m="Propagation",b="setAttribute",y="relatedTarget",S="addEventListener",p=Symbol(r),x=Object,E=document,H=typeof TouchEvent<"u"?TouchEvent:void 0,M=HTMLElement,w=M[h],U=Event[h],F=[a,"dbl"+a,"mousedown","mouseup","touchstart","touchend","pointerdown","pointerup"],C=new Set(F),T=new Set(F.map(t=>e+t+r)),A=(t,o)=>!!o&&t instanceof o,k=(t,o)=>t.contains(o),f=(t,o)=>{for(let c of t)o(c)},R=t=>{A(t,M)&&(t[p]?G(t):f(C,o=>{let c=e+o+r,v=t.getAttribute(c);v&&!_(t)[c]&&t[b](c,v)}),f(t.childNodes,R))},_=t=>t[p]=t[p]||{},G=t=>{_(t),g.includes(t)||(g.push(t),I=!0)},te=(t,o)=>k(o,t)?1:k(t,o)?-1:0,re=t=>{I&&(g.sort(te),I=!1);let o=t[d];A(t,H)?(t=new H(t.type+r,t))[y]=o:t=new t.constructor(t.type+r,x.assign({},t,{[y]:o})),t[s]=[],f(g,c=>{k(c,o)||t[s].some(v=>k(v,c))||c.dispatchEvent(t)})},z=t=>function(){let o=this,c=o.type;t[i](o),T.has(e+c)&&o[s].push(o[d])},L=(t,o,c)=>t[o]=c(t[o]);function ne(t){let o=this[p][e+t.type];o&&o[i](this,[t])}let g=[],I=!1,J=E.createElement(n);f(C,t=>{E[S](t,re,{passive:!0,capture:!0});let o=e+t+r;x.defineProperty(w,o,{get(){return this[p][o]},set(c){this[S](t+r,ne),this[p][o]=typeof c=="object"?c.handleEvent:c}})}),L(w,S,t=>function(...o){T.has(e+o[0])&&G(this),t[i](this,o)}),L(w,b,t=>function(o,c){T.has(o)?(t[i](J,[e+a,c]),this[o]=J[e+a]):t[i](this,[o,c])}),L(U,s+m,z),L(U,s+"Immediate"+m,z),new MutationObserver(t=>{f(t,o=>{f(o.addedNodes,R),f(o.removedNodes,c=>{A(c,M)&&(g=g.filter(v=>!k(c,v)))})})}).observe(E.documentElement,{childList:!0,subtree:!0}),R(E[n])})();const l=document.querySelector("#musicName");document.querySelector("#artistName");document.querySelector("#searchBtn");const u=document.querySelector("#listResults"),j=Y(u),q=Y(j),X=document.querySelector("#appMusicRec"),ce=Z(W,0),le=Z(V(1e3)),N={first:"audioscrobbler",second:"musicovery",third:"spotify"};function Y(e){return e.parentNode}function Z(e,r=1){let n;return function(...s){clearTimeout(n),n=setTimeout(()=>{e(...s)},r)}}function ue(e,r){u.innerHTML="";let n=[...new Set(e)];for(let s=n.length;s>r;s--)n.shift();return n}function D(e,r=!1){let n=document.createElement("option");n.text=`${e.name} from ${e.artist}`,r?(n.value=`${e.trackId},${e.artistId}, ${e.market[0]}`,n.setAttribute("id",`${e.trackId}-${e.market}`)):(n.value=`${e.name},${e.artist}`,n.setAttribute("id",`${e.name}-${e.artist}`)),u.appendChild(n)}function K(e){console.error(e)}function $(e){return e.replaceAll(" ","+")}function B(e){e.removeAttribute("hidden","hidden")}function de(e,r,n){if(r==N.first){let s=Object.values(e)[0],a=Object.values(s)[0],i=[];return Object.keys(a).map(function(d){let h={name:a[d].name,artist:a[d].artist.name};i.push(h)}),i}else if(r==N.second)if(n){let s=Object.values(e)[2],a=Object.values(s)[0];Object.keys(a).map(function(i){a[i].title,a[i].artist.name,a[i].id})}else{console.log(e);let s=Object.values(e),a=Object.values(s[2]);return{name:a[1],artist:a[4].name,id:a[0]}}}function pe(e,r){let n=[...new Set(e)];for(let s=n.length;s>r;s--)n.shift();if(e==null||!e)throw"list indefinied";return n}function fe(e){let r=e.split(""),n=[];for(let s=0;s<r.length;s++)r[s]!=" "&&n.push(r[s]);return n}function ee(e){return!(e==null||e==null)}function P(e){if(ee(e)==!1)return!1;{let r=[];return r=fe(e),r.length!=0}}function he(e){console.log(e),X.innerHTML+=`<p>Listen to ${e.name} from ${e.artist} </p>`}function Q(){X.innerHTML=""}async function O(e,r=!1){if(l.value=`${e.name}`,r)try{try{let n=await oe(e)}catch(n){console.error(n)}}catch(n){console.error(n)}else try{const n=await ie($(e.name),$(e.artist),5);let s=pe(de(n,N.first,5),5);try{if(s.length==0)throw"Music Not Found";Q(),s.map(a=>{he(a)})}catch(a){console.error(a),a=="Music Not Found"&&(Q(),K())}}catch(n){console.error(n)}}u.addEventListener("change",function(){try{let r=u.value.split(","),n={trackId:r[0],artistId:r[1],market:r[2]};O(n,!0)}catch(e){console.error(e);try{console.log("Using option B to select opt on change event");let n=u.value.split(","),s={name:n[0],artist:n[1]};O(s)}catch(r){console.error(r)}}});l.addEventListener("keypress",e=>{if(e.key==="Enter")if(ee(l.value)==!1){let r=document.createElement("option");r.text="empty",u.appendChild(r)}else{let n=u[0].value.split(","),s={name:n[0],artist:n[1]};try{O(s,!0)}catch(a){console.error(a);try{console.log("using option B to Select Option on keypress"),O(s)}catch(i){console.error(i)}}}});l.addEventListener("focus",e=>{if(P(l.value)==!0)if(u.childElementCount==0)try{le(l.value).map(n=>{D(n,!0)})}catch(r){console.error(r);try{console.log("using Option B to search on focus"),ce($(l.value),5)}catch(n){console.error(n)}}else B(j)});q.addEventListener("clickout",e=>{});q.addEventListener("mouseover",e=>{P(l.value)==!0&&B(j)});q.addEventListener("mouseout",e=>{});l.addEventListener("input",async e=>{if(P(l.value)!=!1){B(j),u.value="";try{u.innerHTML="",u.value="",console.clear(),(await V(l.value)).map(n=>{D(n,!0)})}catch(r){console.error(r);try{console.log("using option B to Search on input"),W($(l.value),5)}catch(n){console.error(n)}}}});export{ie as a,W as g};
