import"./sptJs.79d2e6de.js";import{g as S,a as $}from"./ApiMusic.a2757cb3.js";import{g as y}from"./sptSearchJs.1258029b.js";import{g as A}from"./sptSimilarJs.85992db2.js";import"./sptTokenJs.c9a65f70.js";const a=document.querySelector("#musicName");document.querySelector("#artistName");document.querySelector("#searchBtn");const i=document.querySelector("#listResults"),u=k(i),d=k(u),b=document.querySelector("#appMusicRec"),E=L(S,0),R=L(y(1e3)),p={first:"audioscrobbler",second:"musicovery",third:"spotify"};function k(e){return e.parentNode}function L(e,r=1){let t;return function(...n){clearTimeout(t),t=setTimeout(()=>{e(...n)},r)}}function T(e,r){i.innerHTML="";let t=[...new Set(e)];for(let n=t.length;n>r;n--)t.shift();return t}function f(e,r=!1){let t=document.createElement("option");t.text=`${e.name} from ${e.artist}`,r?(t.value=`${e.trackId} - ${e.artistId} - ${e.market}`,t.setAttribute("id",`${e.trackId}-${e.market}`)):(t.value=`${e.name},${e.artist}`,t.setAttribute("id",`${e.name}-${e.artist}`)),i.appendChild(t)}function j(e){console.error(e)}function l(e){return e.replaceAll(" ","+")}function m(e){e.removeAttribute("hidden","hidden")}function w(e,r,t){if(r==p.first){let n=Object.values(e)[0],o=Object.values(n)[0],s=[];return Object.keys(o).map(function(g){let O={name:o[g].name,artist:o[g].artist.name};s.push(O)}),s}else if(r==p.second)if(t){let n=Object.values(e)[2],o=Object.values(n)[0];Object.keys(o).map(function(s){o[s].title,o[s].artist.name,o[s].id})}else{let n=Object.values(e),o=Object.values(n[2]);return{name:o[1],artist:o[4].name,id:o[0]}}}function D(e,r){let t=[...new Set(e)];for(let n=t.length;n>r;n--)t.shift();if(e==null||!e)throw"list indefinied";return t}function I(e){let r=e.split(""),t=[];for(let n=0;n<r.length;n++)r[n]!=" "&&t.push(r[n]);return t}function M(e){return!(e==null||e==null)}function h(e){if(M(e)==!1)return!1;{let r=[];return r=I(e),r.length!=0}}function q(e){b.innerHTML+=`<p>Listen to ${e.name} from ${e.artist} </p>`}function v(){b.innerHTML=""}async function c(e,r=!1){if(a.value=`${e.name}`,r)try{try{let t=await A(e)}catch(t){console.error(t)}}catch(t){console.error(t)}else try{const t=await $(l(e.name),l(e.artist),5);let n=D(w(t,p.first,5),5);try{if(n.length==0)throw"Music Not Found";v(),n.map(o=>{q(o)})}catch(o){console.error(o),o=="Music Not Found"&&(v(),j())}}catch(t){console.error(t)}}i.addEventListener("change",function(){try{let r=i.value.split(" - "),t={trackId:r[0],artistId:r[1],market:r[2]};c(t,!0)}catch(e){console.error(e);try{console.log("Using option B to select opt on change event");let t=i.value.split(","),n={name:t[0],artist:t[1]};c(n)}catch(r){console.error(r)}}});a.addEventListener("keypress",e=>{if(e.key==="Enter")if(M(a.value)==!1){let r=document.createElement("option");r.text="empty",i.appendChild(r)}else{let t=i[0].value.split(","),n={name:t[0],artist:t[1]};try{c(n,!0)}catch(o){console.error(o);try{console.log("using option B to Select Option on keypress"),c(n)}catch(s){console.error(s)}}}});a.addEventListener("focus",e=>{if(h(a.value)==!0)if(i.childElementCount==0)try{R(a.value).map(t=>{f(t,!0)})}catch(r){console.error(r);try{console.log("using Option B to search on focus"),E(l(a.value),5)}catch(t){console.error(t)}}else m(u)});d.addEventListener("clickout",e=>{});d.addEventListener("mouseover",e=>{h(a.value)==!0&&m(u)});d.addEventListener("mouseout",e=>{});a.addEventListener("input",async e=>{if(h(a.value)!=!1){m(u),i.value="";try{i.innerHTML="",i.value="",console.clear(),(await y(a.value)).map(t=>f(t,!0))}catch(r){console.error(r);try{console.log("using option B to Search on input");let t=await S(l(a.value),5);T(t,limit).map(n=>f(n))}catch(t){console.error(t)}}}});
