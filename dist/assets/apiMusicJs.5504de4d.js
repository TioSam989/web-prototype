import"./clickout-event.18ef986e.js";const T="0394adacbab6526b446f377465aae302",i=document.querySelector("#musicName");document.querySelector("#artistName");document.querySelector("#searchBtn");const a=document.querySelector("#listResults"),u=y(a),p=y(u),S=document.querySelector("#appMusicRec"),A=R(L,0),m={first:"audioscrobbler",second:"musicovery",third:"spotify"};function y(e){return e.parentNode}function R(e,t=1){let r;return function(...n){clearTimeout(r),r=setTimeout(()=>{e(...n)},t)}}function L(e,t){if(a.value="",e!=""){const r=`https://ws.audioscrobbler.com/2.0/?method=track.search&track=${e}&api_key=0394adacbab6526b446f377465aae302&format=json&limit=${t}`;fetch(r,{method:"get",mode:"cors",cache:"no-store",timeout:1e3}).then(o=>{o.json().then(s=>{let c=Object.values(s)[0],f=Object.values(c)[4],d=Object.values(f)[0],v=[];Object.keys(d).map(function(g){let E={name:q(d[g].name),artist:d[g].artist};v.push(E),N(v,t).map(M=>I(M))})}).catch(s=>console.error(`i'm broke: ${s.message}`))})}}function q(e){let t=e.replace(/\s*\(.*?\)\s*/g,"");return t!=""||t!=null?t:e}function w(e,t,r){const n=`https://ws.audioscrobbler.com/2.0/?method=track.getsimilar&track=${e}&artist=${t}&api_key=${T}&limit=${r}&format=json&autocorrect=1`;return fetch(n,{method:"GET",mode:"cors",cache:"default"}).then(s=>s.json().then(c=>c)).catch(s=>j(s.message))}function N(e,t){a.innerHTML="";let r=[...new Set(e)];for(let n=r.length;n>t;n--)r.shift();return r}function I(e){let t=document.createElement("option");t.value=`${e.name},${e.artist}`,t.text=`${e.name} from ${e.artist}`,t.setAttribute("id",`${e.name}-${e.artist}`),a.appendChild(t)}function j(e){console.error(e)}function l(e){return e.replaceAll(" ","+")}function h(e){e.removeAttribute("hidden","hidden")}function x(e,t,r){if(t==m.first){let n=Object.values(e)[0],o=Object.values(n)[0],s=[];return Object.keys(o).map(function(c){let f={name:o[c].name,artist:o[c].artist.name};s.push(f)}),s}else if(t==m.second)if(r){let n=Object.values(e)[2],o=Object.values(n)[0];Object.keys(o).map(function(s){o[s].title,o[s].artist.name,o[s].id})}else{console.log(e);let n=Object.values(e),o=Object.values(n[2]);return{name:o[1],artist:o[4].name,id:o[0]}}}function D(e,t){let r=[...new Set(e)];for(let n=r.length;n>t;n--)r.shift();if(e==null||!e)throw"list indefinied";return r}function F(e){let t=e.split(""),r=[];for(let n=0;n<t.length;n++)t[n]!=" "&&r.push(t[n]);return r}function O(e){return!(e==null||e==null)}function b(e){if(O(e)==!1)return!1;{let t=[];return t=F(e),t.length!=0}}function P(e){console.log(e),S.innerHTML+=`<p>Listen to ${e.name} from ${e.artist} </p>`}function k(){S.innerHTML=""}async function $(e){i.value=`${e.name}`;try{const t=await w(l(e.name),l(e.artist),5);let r=D(x(t,m.first,5),5);try{if(r.length==0)throw"Music Not Found";k(),r.map(n=>{P(n)})}catch(n){console.error(n),n=="Music Not Found"&&(k(),j())}}catch(t){console.error(t)}}a.addEventListener("change",function(){let t=a.value.split(","),r={name:t[0],artist:t[1]};$(r)});i.addEventListener("keypress",e=>{if(e.key==="Enter")if(O(i.value)==!1){let t=document.createElement("option");t.text="empty",a.appendChild(t)}else{let r=a[0].value.split(","),n={name:r[0],artist:r[1]};$(n)}});i.addEventListener("focus",e=>{b(i.value)==!0&&(a.childElementCount==0?A(l(i.value),5):h(u))});p.addEventListener("clickout",e=>{});p.addEventListener("mouseover",e=>{b(i.value)==!0&&h(u)});p.addEventListener("mouseout",e=>{});i.addEventListener("input",e=>{b(i.value)==!1||(h(u),L(l(i.value),5))});
