import"./sptJs.79d2e6de.js";import{g as V}from"./sptSearchJs.1258029b.js";import{g as oe}from"./sptSimilarJs.85992db2.js";const se="0394adacbab6526b446f377465aae302";function ae(e){let n=e.replace(/\s*\(.*?\)\s*/g,"");return n!=""||n!=null?n:e}function W(e,n){if(listResults.value="",e=="")divResults;else{const r=`https://ws.audioscrobbler.com/2.0/?method=track.search&track=${e}&api_key=0394adacbab6526b446f377465aae302&format=json&limit=${n}`;fetch(r,{method:"get",mode:"cors",cache:"no-store",timeout:1e3}).then(a=>{a.json().then(i=>{let d=Object.values(i)[0],f=Object.values(d)[4],h=Object.values(f)[0],b=[];Object.keys(h).map(function(y){let S={name:ae(h[y].name),artist:h[y].artist};return b.push(S),b})}).catch(i=>console.error(`i'm broke: ${i.message}`))})}}function ie(e,n,r){const s=`https://ws.audioscrobbler.com/2.0/?method=track.getsimilar&track=${e}&artist=${n}&api_key=${se}&limit=${r}&format=json&autocorrect=1`;return fetch(s,{method:"GET",mode:"cors",cache:"default"}).then(i=>i.json().then(d=>d)).catch(i=>K(i.message))}(function(){const e="on",n="out",r="body",s="stop",a="click",i="apply",d="target",f="prototype",h="Propagation",b="setAttribute",y="relatedTarget",S="addEventListener",m=Symbol(n),x=Object,E=document,H=typeof TouchEvent<"u"?TouchEvent:void 0,M=HTMLElement,w=M[f],U=Event[f],F=[a,"dbl"+a,"mousedown","mouseup","touchstart","touchend","pointerdown","pointerup"],C=new Set(F),T=new Set(F.map(t=>e+t+n)),A=(t,o)=>!!o&&t instanceof o,k=(t,o)=>t.contains(o),p=(t,o)=>{for(let c of t)o(c)},R=t=>{A(t,M)&&(t[m]?G(t):p(C,o=>{let c=e+o+n,g=t.getAttribute(c);g&&!_(t)[c]&&t[b](c,g)}),p(t.childNodes,R))},_=t=>t[m]=t[m]||{},G=t=>{_(t),v.includes(t)||(v.push(t),I=!0)},te=(t,o)=>k(o,t)?1:k(t,o)?-1:0,re=t=>{I&&(v.sort(te),I=!1);let o=t[d];A(t,H)?(t=new H(t.type+n,t))[y]=o:t=new t.constructor(t.type+n,x.assign({},t,{[y]:o})),t[s]=[],p(v,c=>{k(c,o)||t[s].some(g=>k(g,c))||c.dispatchEvent(t)})},z=t=>function(){let o=this,c=o.type;t[i](o),T.has(e+c)&&o[s].push(o[d])},L=(t,o,c)=>t[o]=c(t[o]);function ne(t){let o=this[m][e+t.type];o&&o[i](this,[t])}let v=[],I=!1,J=E.createElement(r);p(C,t=>{E[S](t,re,{passive:!0,capture:!0});let o=e+t+n;x.defineProperty(w,o,{get(){return this[m][o]},set(c){this[S](t+n,ne),this[m][o]=typeof c=="object"?c.handleEvent:c}})}),L(w,S,t=>function(...o){T.has(e+o[0])&&G(this),t[i](this,o)}),L(w,b,t=>function(o,c){T.has(o)?(t[i](J,[e+a,c]),this[o]=J[e+a]):t[i](this,[o,c])}),L(U,s+h,z),L(U,s+"Immediate"+h,z),new MutationObserver(t=>{p(t,o=>{p(o.addedNodes,R),p(o.removedNodes,c=>{A(c,M)&&(v=v.filter(g=>!k(c,g)))})})}).observe(E.documentElement,{childList:!0,subtree:!0}),R(E[r])})();const l=document.querySelector("#musicName");document.querySelector("#artistName");document.querySelector("#searchBtn");const u=document.querySelector("#listResults"),j=Y(u),D=Y(j),X=document.querySelector("#appMusicRec"),ce=Z(W,0),le=Z(V(1e3)),N={first:"audioscrobbler",second:"musicovery",third:"spotify"};function Y(e){return e.parentNode}function Z(e,n=1){let r;return function(...s){clearTimeout(r),r=setTimeout(()=>{e(...s)},n)}}function ue(e,n){u.innerHTML="";let r=[...new Set(e)];for(let s=r.length;s>n;s--)r.shift();return r}function q(e,n=!1){let r=document.createElement("option");r.text=`${e.name} from ${e.artist}`,n?(r.value=`${e.trackId} - ${e.artistId} - ${e.market}`,r.setAttribute("id",`${e.trackId}-${e.market}`)):(r.value=`${e.name},${e.artist}`,r.setAttribute("id",`${e.name}-${e.artist}`)),u.appendChild(r)}function K(e){console.error(e)}function $(e){return e.replaceAll(" ","+")}function B(e){e.removeAttribute("hidden","hidden")}function de(e,n,r){if(n==N.first){let s=Object.values(e)[0],a=Object.values(s)[0],i=[];return Object.keys(a).map(function(d){let f={name:a[d].name,artist:a[d].artist.name};i.push(f)}),i}else if(n==N.second)if(r){let s=Object.values(e)[2],a=Object.values(s)[0];Object.keys(a).map(function(i){a[i].title,a[i].artist.name,a[i].id})}else{let s=Object.values(e),a=Object.values(s[2]);return{name:a[1],artist:a[4].name,id:a[0]}}}function pe(e,n){let r=[...new Set(e)];for(let s=r.length;s>n;s--)r.shift();if(e==null||!e)throw"list indefinied";return r}function fe(e){let n=e.split(""),r=[];for(let s=0;s<n.length;s++)n[s]!=" "&&r.push(n[s]);return r}function ee(e){return!(e==null||e==null)}function P(e){if(ee(e)==!1)return!1;{let n=[];return n=fe(e),n.length!=0}}function he(e){X.innerHTML+=`<p>Listen to ${e.name} from ${e.artist} </p>`}function Q(){X.innerHTML=""}async function O(e,n=!1){if(l.value=`${e.name}`,n)try{try{let r=await oe(e)}catch(r){console.error(r)}}catch(r){console.error(r)}else try{const r=await ie($(e.name),$(e.artist),5);let s=pe(de(r,N.first,5),5);try{if(s.length==0)throw"Music Not Found";Q(),s.map(a=>{he(a)})}catch(a){console.error(a),a=="Music Not Found"&&(Q(),K())}}catch(r){console.error(r)}}u.addEventListener("change",function(){try{let n=u.value.split(" - "),r={trackId:n[0],artistId:n[1],market:n[2]};O(r,!0)}catch(e){console.error(e);try{console.log("Using option B to select opt on change event");let r=u.value.split(","),s={name:r[0],artist:r[1]};O(s)}catch(n){console.error(n)}}});l.addEventListener("keypress",e=>{if(e.key==="Enter")if(ee(l.value)==!1){let n=document.createElement("option");n.text="empty",u.appendChild(n)}else{let r=u[0].value.split(","),s={name:r[0],artist:r[1]};try{O(s,!0)}catch(a){console.error(a);try{console.log("using option B to Select Option on keypress"),O(s)}catch(i){console.error(i)}}}});l.addEventListener("focus",e=>{if(P(l.value)==!0)if(u.childElementCount==0)try{le(l.value).map(r=>{q(r,!0)})}catch(n){console.error(n);try{console.log("using Option B to search on focus"),ce($(l.value),5)}catch(r){console.error(r)}}else B(j)});D.addEventListener("clickout",e=>{});D.addEventListener("mouseover",e=>{P(l.value)==!0&&B(j)});D.addEventListener("mouseout",e=>{});l.addEventListener("input",async e=>{if(P(l.value)!=!1){B(j),u.value="";try{u.innerHTML="",u.value="",console.clear(),(await V(l.value)).map(r=>q(r,!0))}catch(n){console.error(n);try{console.log("using option B to Search on input");let r=await W($(l.value),5);ue(r,limit).map(s=>q(s))}catch(r){console.error(r)}}}});export{ie as a,W as g};
